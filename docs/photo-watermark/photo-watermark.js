// Generated by Haxe 4.0.5
(function ($global) { "use strict";
var App = function() { };
var PhotoWatermark = function() {
	var _gthis = this;
	window.document.addEventListener("DOMContentLoaded",function(event) {
		window.console.log("" + App.NAME + " - PhotoWatermark - Dom ready :: build: " + "2020-05-06 11:23:23");
		_gthis.init();
	});
};
PhotoWatermark.main = function() {
	var app = new PhotoWatermark();
};
PhotoWatermark.prototype = {
	init: function() {
		var _gthis = this;
		this.loadWaterMarkImage();
		var form = window.document.getElementById("photo-watermark");
		form.onsubmit = function(event) {
			window.console.log("Saving value");
			event.preventDefault();
		};
		var input = window.document.getElementById("exampleFormControlFile1");
		input.onchange = function(e) {
			var fileList = e.files;
			if(input.files.length > 0) {
				var file = input.files[0];
				window.console.log("You chose: ",file.name);
				window.console.log("Weight: ",file.size);
				window.console.log("Type: ",file.type);
				var previewText = window.document.getElementById("filePreviewText");
				var bytes = file.size;
				var sizes = ["Bytes","KB","MB","GB","TB"];
				var tmp;
				if(bytes == 0) {
					tmp = "0 Byte";
				} else {
					var i = Math.floor(Math.log(bytes) / Math.log(1024)) | 0;
					tmp = Math.round(bytes / Math.pow(1024,i)) + " " + sizes[i];
				}
				previewText.innerText = "" + file.name + "\" is " + tmp;
				var previewImg = window.document.getElementById("filePreview");
				var fileReader = new FileReader();
				fileReader.onload = function() {
					previewImg.src = fileReader.result;
					_gthis.createImage(fileReader.result);
				};
				fileReader.readAsDataURL(file);
			}
		};
		var fileSelect = window.document.getElementById("fileSelect");
		var fileElem = input;
		fileSelect.onclick = function(e1) {
			if(fileElem != null) {
				fileElem.click();
			}
		};
	}
	,createImage: function(result) {
		var _gthis = this;
		this.selectedImg = new Image();
		this.selectedImg.onload = function() {
			_gthis.imageLoaded();
		};
		this.selectedImg.src = result;
	}
	,imageLoaded: function() {
		var canvas = window.document.getElementById("canvas");
		canvas.width = this.selectedImg.width;
		canvas.height = this.selectedImg.height;
		var ctx = canvas.getContext("2d",null);
		ctx.drawImage(this.selectedImg,0,0);
		ctx.drawImage(this.waterMarkImg,100,100,70,50);
	}
	,loadWaterMarkImage: function() {
		this.waterMarkImg = new Image();
		this.waterMarkImg.onload = function(e) {
			window.console.log(e);
		};
		this.waterMarkImg.src = "watermark.png";
	}
};
App.NAME = "[js-mini-projects]";
PhotoWatermark.main();
})({});
